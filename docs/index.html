<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador de Biologia Imersivo</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:Arial, sans-serif; }
body { background: linear-gradient(to bottom, #d0f0d0, #f0fff0); display:flex; flex-direction:column; align-items:center; justify-content:flex-start; height:100vh; overflow:hidden; touch-action: manipulation; }
h1 { margin:15px; color:#1b5e20; text-shadow:1px 1px 2px #fff; text-align:center; }
#gameArea { position:relative; width:90vw; height:70vh; border:3px solid #1b5e20; border-radius:15px; background:#a8e6a3; overflow:hidden; display:flex; flex-direction:column; justify-content:flex-start; }
.cell { position:absolute; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold; cursor:pointer; user-select:none; transition: transform 0.2s, opacity 0.3s; }
.cell.normal { background: radial-gradient(circle,#80c080 0%,#338033 100%); width:50px; height:50px; }
.cell.fast { background: radial-gradient(circle,#ffd700 0%,#ffa500 100%); width:40px; height:40px; }
.cell.resistant { background: radial-gradient(circle,#ff6347 0%,#b22222 100%); width:60px; height:60px; }
.cell.legendary { background: radial-gradient(circle,#8a2be2 0%,#4b0082 100%); width:70px; height:70px; animation: pulse 1s infinite alternate; }
@keyframes pulse { from { transform:scale(1); } to { transform:scale(1.2); } }
.cell:hover { transform: scale(1.3); }
#scoreBoard { margin-top:15px; font-size:18px; font-weight:bold; color:#1b5e20; text-align:center; }
.btn { margin:10px 5px; padding:10px 20px; border:none; border-radius:10px; background-color:#1b5e20; color:white; font-weight:bold; font-size:16px; cursor:pointer; transition: background-color 0.2s; }
.btn:hover { background-color:#338033; }
#message { margin-top:10px; font-size:16px; color:#1b5e20; font-style:italic; min-height:20px; text-align:center; }
.particle { position:absolute; border-radius:50%; pointer-events:none; }
.badge { display:inline-block; background:#ffd700; color:#000; padding:2px 6px; margin:2px; border-radius:5px; font-size:12px; }
</style>
</head>
<body>
<h1>Simulador de Biologia Imersivo</h1>
<div id="gameArea"></div>
<div id="scoreBoard">Pontuação: 0 | Nível: 1 | Recorde: 0</div>
<div id="message">Clique nas células para estudá-las!</div>
<div id="badges"></div>
<button class="btn" onclick="startGame()">Iniciar Jogo</button>
<button class="btn" onclick="upgrade()">Evoluir Célula (+1)</button>
<audio id="clickSound" src="https://freesound.org/data/previews/522/522640_945474-lq.mp3"></audio>
<audio id="ambientSound" src="https://freesound.org/data/previews/341/341695_62405-lq.mp3" loop></audio>

<script>
let gameArea = document.getElementById('gameArea');
let scoreBoard = document.getElementById('scoreBoard');
let message = document.getElementById('message');
let badgesDiv = document.getElementById('badges');
let score = 0;
let level = 1;
let record = localStorage.getItem('bioRecord') || 0;
let gameInterval;
let cellSpeed = 2000;
let maxCells = 5;
let achievements = { first10:false, first50:false, first100:false };
let clickSound = document.getElementById('clickSound');
let ambientSound = document.getElementById('ambientSound');
ambientSound.volume=0.2;

const cellTypes = [
    { type:'normal', points:1 },
    { type:'fast', points:2 },
    { type:'resistant', points:3 },
    { type:'legendary', points:10 }
];

function randomCellType(){
    let rand = Math.random();
    if(rand < 0.6) return cellTypes[0];
    else if(rand < 0.85) return cellTypes[1];
    else if(rand < 0.97) return cellTypes[2];
    else return cellTypes[3];
}

function createCell(){
    let cellData = randomCellType();
    let cell = document.createElement('div');
    cell.classList.add('cell', cellData.type);
    cell.textContent='C';
    let maxX=gameArea.clientWidth-70;
    let maxY=gameArea.clientHeight-70;
    let posX=Math.random()*maxX;
    let posY=Math.random()*maxY;
    cell.style.left=posX+'px';
    cell.style.top=posY+'px';

    cell.addEventListener('click', ()=>{
        score += cellData.points;
        if(score>record){ record=score; localStorage.setItem('bioRecord',record);}
        scoreBoard.textContent=`Pontuação: ${score} | Nível: ${level} | Recorde: ${record}`;
        message.textContent=`Você estudou uma célula ${cellData.type}!`;
        clickSound.currentTime=0; clickSound.play();
        createParticles(posX+25,posY+25,cellData.type);
        cell.remove();
        checkLevelUp();
        checkAchievements();
    });

    gameArea.appendChild(cell);
    setTimeout(()=>{ if(cell.parentNode){ cell.remove(); message.textContent=`Uma célula ${cellData.type} escapou!`; }}, cellData.type==='fast'?3000:5000);
}

function createParticles(x,y,type){
    for(let i=0;i<10;i++){
        let p=document.createElement('div');
        p.classList.add('particle');
        p.style.width='6px'; p.style.height='6px';
        p.style.backgroundColor=type==='fast'?'#ff0':type==='resistant'?'#f44':type==='legendary'?'#8a2be2':'#4f4';
        p.style.left=x+'px'; p.style.top=y+'px';
        gameArea.appendChild(p);
        let angle=Math.random()*2*Math.PI;
        let distance=Math.random()*50;
        let dx=Math.cos(angle)*distance; let dy=Math.sin(angle)*distance;
        p.animate([{transform:'translate(0,0)',opacity:1},{transform:`translate(${dx}px,${dy}px)`,opacity:0}],{duration:600,easing:'ease-out'});
        setTimeout(()=>p.remove(),600);
    }
}

function checkLevelUp(){
    let newLevel=Math.floor(score/20)+1;
    if(newLevel>level){ level=newLevel; cellSpeed=Math.max(400,cellSpeed-200); maxCells++; message.textContent=`Você atingiu o nível ${level}!`; restartGameInterval();}
}

function checkAchievements(){
    if(score>=10 && !achievements.first10){ achievements.first10=true; addBadge("Primeiros 10 pontos!");}
    if(score>=50 && !achievements.first50){ achievements.first50=true; addBadge("50 pontos alcançados!");}
    if(score>=100 && !achievements.first100){ achievements.first100=true; addBadge("100 pontos! Mestre da Biologia!");}
}

function addBadge(text){
    let b=document.createElement('span');
    b.classList.add('badge'); b.textContent=text; badgesDiv.appendChild(b);
}

function upgrade(){
    cellSpeed=Math.max(400,cellSpeed-300);
    message.textContent="As células estão se multiplicando mais rápido!";
    restartGameInterval();
}

function startGame(){
    clearInterval(gameInterval);
    score=0; level=1; cellSpeed=2000; maxCells=5; achievements={first10:false,first50:false,first100:false};
    gameArea.innerHTML=''; badgesDiv.innerHTML=''; scoreBoard.textContent=`Pontuação: ${score} | Nível: ${level} | Recorde: ${record}`;
    message.textContent="O estudo começou!"; ambientSound.play();
    restartGameInterval();
}

function restartGameInterval(){
    clearInterval(gameInterval);
    gameInterval=setInterval(()=>{
        let cellsInGame=gameArea.querySelectorAll('.cell').length;
        if(cellsInGame<maxCells) createCell();
    },cellSpeed);
}
</script>
</body>
</html>
